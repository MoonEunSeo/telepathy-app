// src/utils/badwords.js
const bannedWords = [
    // ğŸ”¹ ê¸ˆìœµ/ê±°ë˜/ìŠ¤íŒ¸
    "ê³„ì¢Œ", "ì…ê¸ˆ", "ì†¡ê¸ˆ", "ì¶œê¸ˆ", "ëŒ€ì¶œ", "í† í† ", "ì¹´ì§€ë…¸", "ë°°íŒ…", "ì•Œë°”", "ê³ ìˆ˜ìµ", "ê³ ìˆ˜ìœ„", "ë¶ˆë²•",
  
    // ğŸ”¹ í˜ì˜¤/ë¹„í•˜
    "í•œë‚¨", "ê¼´í˜ë¯¸", "ë³‘ì‹ ", "ì‹œë°œ", "ì¢†", "ì”¨ë°œ", "ê°œìƒˆë¼", "fuck", "shit", "ì§€ë„", "ì—¼ë³‘", "ì„¹1ìŠ¤", "ì„¹@ìŠ¤","ì„¹2ìŠ¤",
  
    // ğŸ”¹ ìŒë€/ë¶ˆê±´ì „
    "ì„¹ìŠ¤", "sex", "porn", "ììœ„", "ì—ë¡œ", "ì•¼ë™", "AV", "ì‹ ìŒ", "í›„ë°°ìœ„", "ì •ìƒìœ„", "ì²´ìœ„", "ì •ì•¡", "ê¼¬ì¶”", "ê±°ì‹œê¸°", "ì„±ê¸°", "ë³´ì§€", "ìì§€", "ì”¹ì§ˆ",
  
    // ğŸ”¹ ì •ì¹˜/ì¢…êµ ê³¼ë„ í™ë³´ (í•„ìš”ì‹œ í™•ì¥)
    "ë¬¸ì¬ì¸", "ìœ¤ì„ì—´", "ë°•ê·¼í˜œ", "ë…¸ë¬´í˜„", "ì´ê¸°ì•¼", "ì¼ë² ", "í¨ì½”", "ë¯¼ì£¼ë‹¹", "êµ­ë¯¼ì˜í˜", "êµíšŒ", "ì˜ˆìˆ˜", "í•˜ëŠë‹˜", "í•˜ë‚˜ë‹˜", "ì‹ ì²œì§€", "ë°•ì •í¬", "ì´ì¬ëª…", "ê¹€ì •ì€", "ìˆ˜ë ¹ë™ì§€"
  ];
  
const bannedPatterns = [
    // ğŸ”¹ ê°œì¸ì •ë³´
    /\d{3}-\d{4}-\d{4}/,      // ì „í™”ë²ˆí˜¸ (010-1234-5678)
    /\d{11}/,                 // ì—°ì†ëœ ìˆ«ì 11ìë¦¬ (ì£¼ë¯¼ë²ˆí˜¸/ì „í™”ë²ˆí˜¸)
    /\d{2,4}-\d{2,4}-\d{2,4}/, // ê³„ì¢Œë²ˆí˜¸ íŒ¨í„´
    /\S+@\S+\.\S+/,           // ì´ë©”ì¼
  
    // ğŸ”¹ ì™¸ë¶€ í™ë³´/ë§í¬
    /(http|https):\/\/\S+/,   // URL
    /www\.\S+/,               // www.ë¡œ ì‹œì‘í•˜ëŠ” ì£¼ì†Œ
    /@[a-zA-Z0-9_]+/,         // SNS ì•„ì´ë”” (ì¸ìŠ¤íƒ€/íŠ¸ìœ„í„° ë“±)
  
    // ğŸ”¹ ë³´ì•ˆìœ„í—˜/ë„ë°°
    /<script.*?>.*?<\/script>/i, // XSS ìŠ¤í¬ë¦½íŠ¸ íƒœê·¸
    /select\s+\*\s+from/i,       // SQL injection
    /drop\s+table/i,             // SQL injection
    /(.)\1{15,}/,                 // ê°™ì€ ë¬¸ì 16íšŒ ì´ìƒ ë°˜ë³µ (!!!!!!!, ã…‹ã…‹ã…‹ã…‹ã…‹ã…‹)
    /\p{C}+/u,                   // ì œì–´ë¬¸ì (zero-width space ë“±)
  ];
  
  function filterMessage(message) {
    let filtered = message;
    for (const word of bannedWords) {
      const regex = new RegExp(word, "gi");
      filtered = filtered.replace(regex, "***");
    }
    for (const pattern of bannedPatterns) {
      if (pattern.test(filtered)) {
        filtered = filtered.replace(pattern, "***");
      }
    }
    return filtered;
  }
  
  module.exports = {
    bannedWords,
    bannedPatterns,
    filterMessage,
  };